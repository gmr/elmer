This is a very, very rough work in progress as I'm figuring out how to best do this.  If you have suggestions or fixes, please let me know.
